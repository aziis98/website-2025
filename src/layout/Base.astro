---
import '@fontsource-variable/inter'
import '@fontsource-variable/outfit'
import '@fontsource-variable/jetbrains-mono'

import '@fontsource/iosevka'

import 'katex/dist/katex.min.css'

import '@/main.css'
import { PixelartPlantRect } from '@/components/preact/plant-pixelart'

type Props = {
    title?: string | string[]
}

const { title } = Astro.props
---

<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />

        <script>
            // @ts-nocheck
            // This import "katex" only on the client side, on the user's browser.
            import katex from 'katex'

            document.addEventListener('DOMContentLoaded', function () {
                document.querySelectorAll('.math-inline').forEach($e => {
                    const $s = document.createElement('span')
                    $e.parentElement.insertBefore($s, $e)

                    katex.render($e.textContent, $e, {
                        throwOnError: false,
                        displayMode: false,
                        trust: true,
                    })

                    $s.appendChild($e.firstChild)
                    $e.remove()
                })

                document.querySelectorAll('.math-display').forEach($e => {
                    const $p = document.createElement('p')
                    const $s = document.createElement('span')
                    $p.appendChild($s)

                    $e.parentElement.insertBefore($p, $e)

                    katex.render($e.textContent, $e, {
                        throwOnError: false,
                        displayMode: true,
                        trust: true,
                    })

                    $s.appendChild($e.firstChild)
                    $e.remove()
                })
            })
        </script>

        <title>{['aziis98', title ?? []].flat().reverse().join(' | ')}</title>
    </head>
    <body>
        <header>
            <!-- Header Art -->
            <PixelartPlantRect
                client:visible
                options={{
                    cellColor: '#88888806',
                    spawnLocation: 'top',
                }}
            />

            <a class="logo" href="/">aziis98</a>

            <div class="header-title">
                <slot name="header-title" />
            </div>
        </header>
        <main>
            <nav class="sidebar">
                <PixelartPlantRect
                    client:load
                    updateInterval={5}
                    stopTimeout={5000}
                    width={7 * 5}
                    height={50 * 5}
                    options={{ cellColor: 'hsl(266, 100%, 70%)', spawnLocation: 'bottom' }}
                />

                <a class="nav-item" href="/">Home</a>

                <a class="nav-item" href="/blog">Blog</a>

                <a class="nav-item" href="/art">Art</a>

                <a class="nav-item" href="/projects">Projects</a>

                <a class="nav-item" href="/about">About</a>

                <PixelartPlantRect
                    client:load
                    updateInterval={5}
                    stopTimeout={5000}
                    width={7 * 5}
                    height={50 * 5}
                    options={{ cellColor: 'hsl(266, 100%, 70%)', spawnLocation: 'top' }}
                />
            </nav>

            <slot />
        </main>
    </body>
</html>
